function A3LMonacoEditor(n){var i="<div id=\"{{monaco_editor_id}}\" class=\"MonacoEditor\"><script>var editorFormula;function verificarRequireYSetMonacoEditor() {\tconsole.log(\"verificarRequireYSetMonacoEditor\");    if (typeof require !== 'undefined') {        setMonacoEditor(true, '{{{url_sug_QueryString}}}');\t    } else {                setTimeout(verificarRequireYSetMonacoEditor, 500);    }}gx.fx.obs.addObserver(\"gx.onload\", window, /*setMonacoEditor(true, '{{{url_sug_QueryString}}}')*/verificarRequireYSetMonacoEditor());function setMonacoEditor(crear, url_sug_QS) {\t\tconsole.log(\"setmonacoeditor\");\t\trequire.config({paths: {vs: 'vs'}});\t\trequire(['vs/editor/editor.main'], function() {\t\t\t\tif(crear == true){\t\t\tmonaco.editor.getModels().forEach(model => model.dispose());\t\t}\t\t\t\tmonaco.languages.register({id: '{{{nombreLenguaje}}}' });\t\tconfig = {{{monaco_brackets}}};\t\tmonaco.languages.setLanguageConfiguration(\"{{{nombreLenguaje}}}\", config);\t   \t\tmonaco.languages.setMonarchTokensProvider('{{{nombreLenguaje}}}', {\t\ttokenizer: {root: [{{{monaco_tokens}}}]}});       \t\tmonaco.editor.defineTheme('monacoTemplate', {\t\t\tbase: 'vs',\t\t\tinherit: false,\t\t\trules: [{{{monaco_tokens_style}}}],\t\t\tcolors: {'editor.foreground': '{{{monaco_foreground}}}'}\t\t});\t\t\t\t\tif(typeof this.completionItemProvider != \"undefined\"){\t\t\tthis.completionItemProvider.dispose();\t\t\t\t\t\tthis.hoverProvider.dispose();\t\t}\t\t\t/*else{*/\t\t\t\tfetch('{{{monaco_url_sug}}}' + url_sug_QS, {\t\t\t}).then(response => {\t\t\t\t\t\treturn response.json();\t\t}).then(sug => {\t\t\t\t\t\tvar element = document.getElementById('{{monaco_editor_id}}');\t\t\tvar columnaHasta = 0;\t\t\tvar suggestionsArray = new Array();\t\t\tvar item = {};\t\t\tvar hoverMap = new Map([[]]);\t\t\t\t\t\t\tvar fetchedSug = sug;\t\t\t\t\t\t/*lo paso aca. Si lo paso acá, funciona siempre el hover, pero funciona el suggest la primera vez solamente*/\t\t\tsuggestionsArray = new Array();\t\t\thoverMap = new Map([[]]);\t\t\tvar obj;\t\t\tfor (var i = 0; i < fetchedSug.length; i++){\t\t\t\tobj = fetchedSug[i];\t\t\t\t\thoverMap.set(obj.insertText.toUpperCase(), obj.hover_value);\t\t\t\t}\t\t\t\t\t\t/*fin*/\t\t\t\t\t\tthis.completionItemProvider = monaco.languages.registerCompletionItemProvider('{{{nombreLenguaje}}}', {\t\t\t\t\tprovideCompletionItems: () => {\t\t\t\t\t\t\t\t\t\t\tif(true){/*if(suggestionsArray.length == 0){*/\t\t\t\t\t\t/*estaba aca. Si lo dejo acá, funciona siempre el suggest, pero el hover solo funciona si primero hago un suggest*/\t\t\t\t\t\tsuggestionsArray = new Array(); /*ojo que descomento esta linea que es problematica como lo explica el renglon anterior*/\t\t\t\t\t\titem = {};\t\t\t\t\t\t/*hoverMap = new Map([[]]);\t\t\t*/\t\t\t\t\t\t\t\t\t\t\t\tfor (var i = 0; i < fetchedSug.length; i++){\t\t\t\t\t\t\tobj = fetchedSug[i];\t\t\t\t\t\t\titem = {};\t\t\t\t\t\t\titem.kind = obj.kind;\t\t\t\t\t\t\titem.label = obj.label;\t\t\t\t\t\t\t\t\t\t\t\titem.insertText = obj.insertText;\t\t\t\t\t\t\titem.insertTextRules = obj.insertTextRules;\t\t\t\t\t\t\t\t\t\t\t\t\t\tsuggestionsArray.push(item);\t\t\t\t\t\t\t\t\t\t\t\t\t\t/*hoverMap.set(obj.insertText, obj.hover_value);*/\t\t\t\t\t\t}\t\t\t\t\t\t}\t\t\t\t\t/*fin*/\t\t\t\t\treturn {\t\t\t\t\t\tsuggestions: suggestionsArray\t\t\t\t\t};\t\t\t\t\t\t\t\t\t},\t\t\t\ttriggerCharacters: [\"0\", \"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\"]\t\t\t}\t\t\t);\t\t\t\t\t\tthis.hoverProvider = monaco.languages.registerHoverProvider('{{{nombreLenguaje}}}', {\t\t\t\tprovideHover: function(model, position) {\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (model.getWordAtPosition(position)) {\t\t\t\t\t\t/*getSugerencia(model,position);*/\t\t\t\t\t\titemContent = '';\t\t\t\t\t\tgetSugerencia(model,position.lineNumer, position.column);\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn {\t\t\t\t\t\t\trange: new monaco.Range(position.lineNumber, position.column, position.lineNumber, position.column),\t\t\t\t\t\t\tcontents: [{\t\t\t\t\t\t\t\tvalue: sug\t\t\t\t\t\t\t}]\t\t\t\t\t\t};\t\t\t\t\t}\t\t\t\t}\t\t\t});\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif(crear == true){\t\t\t\t\t\t\teditorFormula = monaco.editor.create(document.getElementById('{{monaco_editor_id}}'), {\t\t\t\t\tvalue: '{{{valorInicial}}}',\t\t\t\t\tlanguage: '{{{nombreLenguaje}}}',\t\t\t\t\tsuggest: {\t\t\t\t\t\tsnippetsPreventQuickSuggestions: false\t\t\t\t\t},\t\t\t\t\tlineNumbers: '{{{monaco_lineNumbers}}}',\t\t\t\t\twordWrap: '{{{monaco_wordWrap}}}',\t\t\t\t\twordWrapColumn: {{{monaco_Columns}}},\t\t\t\t\ttheme: 'monacoTemplate',\t\t\t\t\treadonly: {{{monaco_readOnly}}},\t\t\t\t\tminimap: {\t\t\t\t\t\tenabled: {{{monaco_miniMap}}}\t\t\t\t\t}\t\t\t\t});\t\t\t}\t\t\t/*codigo markers*/\t\t\tvar model=monaco.editor.getModels()[0];\t\t\t\t\t\t/*if({{{monaco_readOnly}}} == 'false'){*/\t\t\t\tvalidar(model);\t\t/*\t}*/\t\t\tmodel.onDidChangeContent(() => {\t\t\t\t\t\t\t\tActualizarVariable();\t\t\t\t/*if({{{monaco_readOnly}}} == 'false'){*/\t\t\t\t\tvalidar(model);\t\t\t/*\t}*/\t\t\t\t/*element.addEventListener('DOMSubtreeModified', ActualizarVariable);*/\t\t\t\t\t\t\t});\t\t\t\t\t\t/*setTimeout(function(){\t\t\t\telement.addEventListener('DOMSubtreeModified', ActualizarVariable);\t\t\t\t\t\t\t}, 2000);\t\t\t\t\t*/\t\t\tfunction ActualizarVariable(e) {\t\t\t\tgx.dom.byId(\"{{{variable_asociada}}}\")[\"value\"] = editorFormula.getValue();\t\t\t}\t\t\tfunction validar(model){\t\t\t\tconst markers = [];\t\t\t\t\t\t\t\t\t\t\t\tfor (let i = 1; i < model.getLineCount() + 1; i++) {\t\t\t\t\t\t\t\t\t\tconst range = {\t\t\t\t\t\tstartLineNumber: i,\t\t\t\t\t\tstartColumn: 1,\t\t\t\t\t\tendLineNumber: i,\t\t\t\t\t\tendColumn: model.getLineLength(i) + 1\t\t\t\t\t};\t\t\t\t\t\t\t\t\t\tfor (let e = 1; e < model.getLineLength(i) + 1; e++) {\t\t\t\t\t\t\tgetSugerencia(model, i, e);\t\t\t\t\t\t\t\t\t\t\t\t\t\tif( sug == 'Error'){\t\t\t\t\t\t\t\tmarkers.push({\t\t\t\t\t\t\t\t\tmessage: 'Item no reconocido',\t\t\t\t\t\t\t\t\tseverity: monaco.MarkerSeverity.Error,\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstartLineNumber: i,\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstartColumn: e,\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tendLineNumber: i,\t\t\t\t\t\t\t\t\t/*endColumn: range.endColumn*/\t\t\t\t\t\t\t\t\tendColumn: columnaHasta\t\t\t\t\t\t\t\t});\t\t\t\t\t\t\t}\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log('suuuuge ' + sug + ' columna hasta ' + columnaHasta + 'e ' + e + ' ');\t\t\t\t\t\t\te = columnaHasta + 1;\t\t\t\t\t\t}\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/*if (Number.isNaN(number)) {*/\t\t\t\t\t}\t\t\t\tmonaco.editor.setModelMarkers(model, 'owner', markers);\t\t\t\t/*end markers*/\t\t\t}\t\t\t/*function getSugerencia(model,position){*/\t\t\tfunction getSugerencia(model,nroLin,columna ){\t\t\t\t\t\t\t\t\t\tcolumnaDesde = columna;\t\t\t\t\tpos_ant = new Object();\t\t\t\t\t\t\t\t\t\tpos_ant.lineNumber = nroLin;\t\t\t\t\tpos_ant.column = columnaDesde;\t\t\t\t\twhile (model.getWordAtPosition(pos_ant)) {\t\t\t\t\t\tcolumnaDesde--;\t\t\t\t\t\t\t\t\t\t\t\tpos_ant.lineNumber = nroLin;\t\t\t\t\t\tpos_ant.column = columnaDesde;\t\t\t\t\t}\t\t\t\t\t\t\t\t\t\tcolumnaHasta = columna;\t\t\t\t\tpos_post = new Object();\t\t\t\t\t\t\t\t\t\tpos_post.lineNumber = nroLin;\t\t\t\t\tpos_post.column = columnaHasta;\t\t\t\t\twhile (model.getWordAtPosition(pos_post)) {\t\t\t\t\t\tcolumnaHasta++;\t\t\t\t\t\t\t\t\t\t\t\tpos_post.lineNumber = nroLin;\t\t\t\t\t\tpos_post.column = columnaHasta;\t\t\t\t\t}\t\t\t\t\titemContent = model.getValueInRange({\t\t\t\t\t\t\t\t\t\t\t\tstartLineNumber: nroLin,\t\t\t\t\t\tstartColumn: columnaDesde,\t\t\t\t\t\t\t\t\t\t\t\tendLineNumber: nroLin,\t\t\t\t\t\tendColumn: columnaHasta,\t\t\t\t\t});\t\t\t\t\tif (itemContent.substr(itemContent.length - 1, 1) !== \"]\" && itemContent.substr(0, 1) == \"[\" && itemContent.substr(itemContent.length - 1, 1) !== \"}\" && itemContent.substr(0, 1) == \"{\") {\t\t\t\t\t\tif(itemContent.substr(0, 1) == \"[\"){\t\t\t\t\t\t\titemContent += \"]\";\t\t\t\t\t\t}\t\t\t\t\t\telse{\t\t\t\t\t\t\titemContent += \"}\";\t\t\t\t\t\t}\t\t\t\t\t\t\t\t\t\t}\t\t\t\t\titemContent = itemContent.toUpperCase();\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlet permitidos = {{{permitidos}}};\t\t\t\t\t\t\t\t\t\t\t\t\t\t\titemContentAux = itemContent;\t\t\t\t\t\t\t\t\t\tfor(i = 0; i < permitidos.length; i++){\t\t\t\t\t\titemContentAux = itemContentAux.replaceAll(permitidos[i], '');\t\t\t\t\t\tconsole.log('reemplaza ' + permitidos[i]);\t\t\t\t\t\tconsole.log('itemContentAux ' + itemContentAux);\t\t\t\t\t}\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst number = Number(itemContentAux);\t\t\t\t\tconsole.log('itemContentAux ' + itemContentAux);\t\t\t\t\t\t\t\t\t\tif(!Number.isNaN(number) || itemContentAux == '' || itemContentAux == '/' ){\t\t\t\t\t\tsug = '';\t\t\t\t\t}\t\t\t\t\telse{\t\t\t\t\t\tpalabraConcepto = '{{palabra_concepto}}';\t\t\t\t\t\tif (itemContent.indexOf('{' + palabraConcepto + ' ') != -1) {\t\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log('jsMonacoEditorHoverPopups Es Concepto! ' + itemContent);\t\t\t\t\t\t\t\t\telementos = itemContent.split(' ');\t\t\t\t\t\t\tif(elementos.length > 2 || itemContent.indexOf(' {{{totalPalabra}}}]') != -1 ){\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\titemContent = elementos[0] + ' ' + elementos[1] + '}';\t\t\t\t\t\t\t\tconsole.log('itemcontent acortado ' + itemContent);\t\t\t\t\t\t\t}\t\t\t\t\t\t\tif (hoverMap.get(itemContent)) {\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsug = hoverMap.get(itemContent);\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tultimaLetraConcepto = itemContent.substr(17, 1);\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log('ultima letra ' + ultimaLetraConcepto);\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t} \t\t\t\t\t\t\telse {\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsug = 'Error';\t\t\t\t\t\t\t}\t\t\t\t\t\t} \t\t\t\t\t\telse {\t\t\t\t\t\t\tconsole.log('itemContent ' + itemContent);\t\t\t\t\t\t\tconsole.log('hoverMap.get(itemContent) ' + hoverMap.get(itemContent));\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (hoverMap.get(itemContent)) {\t\t\t\t\t\t\t\tsug = hoverMap.get(itemContent);\t\t\t\t\t\t\t}\t\t\t\t\t\t\telse{\t\t\t\t\t\t\t\tsug = 'Error';\t\t\t\t\t\t\t}\t\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log('sug ' + sug);\t\t\t\t\t\t}\t\t\t\t\t}\t\t\t\t\t\t\t}\t\t\teditorFormula.updateOptions({\t\t\t\treadOnly: {{{monaco_readOnly}}},\t\t\t\trenderValidationDecorations: \"on\"\t\t\t});\t\t});\t    \t    });\t} <\/script>",r,t;Mustache.parse(i);this.show=function(){r=n(this.getContainerControl());this.setHtml(Mustache.render(i,this));this.renderChildContainers()};this.Scripts=[];this.autoToggleVisibility=!0;t={};this.renderChildContainers=function(){r.find("[data-slot][data-parent='"+this.ContainerName+"']").each(function(i,r){var e=n(r),f=e.attr("data-slot"),u;u=t[f];u||(u=this.getChildContainer(f),t[f]=u,u.parentNode.removeChild(u));e.append(u);n(u).show()}.closure(this))}}